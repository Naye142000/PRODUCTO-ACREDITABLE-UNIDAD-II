<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nayeli Calderon Damian, Desly Nicoll Carranza Gonzáles, Damaris Monsalve Soto, Lluliana Mas Cruz, Geysler Mariñas Alvarado, Eunis Guelac Mendonza, Flor de maria Chavez Gomez">

<title>Proyecto</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="TRABAJO SEGUNDA UNIDAD_files/libs/clipboard/clipboard.min.js"></script>
<script src="TRABAJO SEGUNDA UNIDAD_files/libs/quarto-html/quarto.js"></script>
<script src="TRABAJO SEGUNDA UNIDAD_files/libs/quarto-html/popper.min.js"></script>
<script src="TRABAJO SEGUNDA UNIDAD_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="TRABAJO SEGUNDA UNIDAD_files/libs/quarto-html/anchor.min.js"></script>
<link href="TRABAJO SEGUNDA UNIDAD_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="TRABAJO SEGUNDA UNIDAD_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="TRABAJO SEGUNDA UNIDAD_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="TRABAJO SEGUNDA UNIDAD_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="TRABAJO SEGUNDA UNIDAD_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#importar-datos" id="toc-importar-datos" class="nav-link active" data-scroll-target="#importar-datos"><span class="header-section-number">1</span> Importar datos</a>
  <ul class="collapse">
  <li><a href="#variable-twue" id="toc-variable-twue" class="nav-link" data-scroll-target="#variable-twue"><span class="header-section-number">1.1</span> Variable Twue</a>
  <ul class="collapse">
  <li><a href="#modelo-lineal-twue" id="toc-modelo-lineal-twue" class="nav-link" data-scroll-target="#modelo-lineal-twue"><span class="header-section-number">1.1.1</span> Modelo lineal Twue</a></li>
  <li><a href="#modelo-lineal-mixto-para-twue" id="toc-modelo-lineal-mixto-para-twue" class="nav-link" data-scroll-target="#modelo-lineal-mixto-para-twue"><span class="header-section-number">1.1.2</span> Modelo lineal mixto para twue</a></li>
  <li><a href="#box-plot-twue" id="toc-box-plot-twue" class="nav-link" data-scroll-target="#box-plot-twue"><span class="header-section-number">1.1.3</span> Box Plot Twue</a></li>
  <li><a href="#comparación-de-medias-twue" id="toc-comparación-de-medias-twue" class="nav-link" data-scroll-target="#comparación-de-medias-twue"><span class="header-section-number">1.1.4</span> Comparación de medias Twue</a></li>
  <li><a href="#gráfico-en-ggplot-2-para-twue" id="toc-gráfico-en-ggplot-2-para-twue" class="nav-link" data-scroll-target="#gráfico-en-ggplot-2-para-twue"><span class="header-section-number">1.1.5</span> Gráfico en ggplot 2 para Twue</a></li>
  <li><a href="#comaparación-de-medias-emmeans-para-twue" id="toc-comaparación-de-medias-emmeans-para-twue" class="nav-link" data-scroll-target="#comaparación-de-medias-emmeans-para-twue"><span class="header-section-number">1.1.6</span> Comaparación de medias: emmeans para twue</a></li>
  <li><a href="#plot-para-twue" id="toc-plot-para-twue" class="nav-link" data-scroll-target="#plot-para-twue"><span class="header-section-number">1.1.7</span> Plot para twue</a></li>
  </ul></li>
  <li><a href="#variable-ttrans" id="toc-variable-ttrans" class="nav-link" data-scroll-target="#variable-ttrans"><span class="header-section-number">1.2</span> Variable TTRANS</a>
  <ul class="collapse">
  <li><a href="#modelo-lineal-para-ttrans" id="toc-modelo-lineal-para-ttrans" class="nav-link" data-scroll-target="#modelo-lineal-para-ttrans"><span class="header-section-number">1.2.1</span> Modelo lineal para ttrans</a></li>
  <li><a href="#modelo-lineal-mixto-para-ttrans" id="toc-modelo-lineal-mixto-para-ttrans" class="nav-link" data-scroll-target="#modelo-lineal-mixto-para-ttrans"><span class="header-section-number">1.2.2</span> Modelo lineal mixto para ttrans</a></li>
  <li><a href="#box-plot-ttrans" id="toc-box-plot-ttrans" class="nav-link" data-scroll-target="#box-plot-ttrans"><span class="header-section-number">1.2.3</span> Box Plot ttrans</a></li>
  <li><a href="#comparación-de-media-ttrans" id="toc-comparación-de-media-ttrans" class="nav-link" data-scroll-target="#comparación-de-media-ttrans"><span class="header-section-number">1.2.4</span> Comparación de media ttrans</a></li>
  <li><a href="#gráfico-en-ggplot-2-para-twue-1" id="toc-gráfico-en-ggplot-2-para-twue-1" class="nav-link" data-scroll-target="#gráfico-en-ggplot-2-para-twue-1"><span class="header-section-number">1.2.5</span> Gráfico en ggplot 2 para Twue</a></li>
  <li><a href="#comaparación-de-medias-emmeans-para-ttrans" id="toc-comaparación-de-medias-emmeans-para-ttrans" class="nav-link" data-scroll-target="#comaparación-de-medias-emmeans-para-ttrans"><span class="header-section-number">1.2.6</span> Comaparación de medias: emmeans para ttrans</a></li>
  <li><a href="#plot-para-ttrans" id="toc-plot-para-ttrans" class="nav-link" data-scroll-target="#plot-para-ttrans"><span class="header-section-number">1.2.7</span> Plot para ttrans</a></li>
  <li><a href="#análisis-multivariado" id="toc-análisis-multivariado" class="nav-link" data-scroll-target="#análisis-multivariado"><span class="header-section-number">1.2.8</span> Análisis multivariado</a></li>
  <li><a href="#pca-para-ttrans" id="toc-pca-para-ttrans" class="nav-link" data-scroll-target="#pca-para-ttrans"><span class="header-section-number">1.2.9</span> PCA para ttrans</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Proyecto</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nayeli Calderon Damian, Desly Nicoll Carranza Gonzáles, Damaris Monsalve Soto, Lluliana Mas Cruz, Geysler Mariñas Alvarado, Eunis Guelac Mendonza, Flor de maria Chavez Gomez </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="importar-datos" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Importar datos</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(googlesheets4)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://docs.google.com/spreadsheets/d/15r7ZwcZZHbEgltlF6gSFvCTFA-CFzVBWwg3mFlRyKPs/edit?gid=172957346#gid=172957346"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> url <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_sheets_id</span>(url)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>fb <span class="ot">&lt;-</span> gs <span class="sc">%&gt;%</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">range_read</span>(<span class="st">"fb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>! Using an auto-discovered, cached token.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  To suppress this message, modify your code or options to clearly consent to
  the use of a cached token.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  See gargle's "Non-interactive auth" vignette for more details:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  &lt;https://gargle.r-lib.org/articles/non-interactive-auth.html&gt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ The googlesheets4 package is using a cached token for
  'calderonnayeli015@gmail.com'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Reading from "LA MOLINA 2014 POTATO WUE (FB)".</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Range ''fb''.</code></pre>
</div>
</div>
<section id="variable-twue" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="variable-twue"><span class="header-section-number">1.1</span> Variable Twue</h2>
<section id="modelo-lineal-twue" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="modelo-lineal-twue"><span class="header-section-number">1.1.1</span> Modelo lineal Twue</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> twue <span class="sc">~</span> bloque <span class="sc">+</span> geno <span class="sc">+</span> riego <span class="sc">+</span> riego<span class="sc">*</span>geno, <span class="at">data =</span> fb)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: twue
            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
bloque       4  21.91  5.4766  8.0849 8.721e-06 ***
geno        14 412.99 29.4995 43.5494 &lt; 2.2e-16 ***
riego        1   2.03  2.0329  3.0011   0.08587 .  
geno:riego  14  16.06  1.1470  1.6933   0.06609 .  
Residuals  116  78.58  0.6774                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="modelo-lineal-mixto-para-twue" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="modelo-lineal-mixto-para-twue"><span class="header-section-number">1.1.2</span> Modelo lineal mixto para twue</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: Matrix</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="at">formula =</span> twue <span class="sc">~</span> riego <span class="sc">+</span> geno <span class="sc">+</span> riego<span class="sc">*</span>geno <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>bloque)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>              ,<span class="at">data =</span> fb)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table
           npar Sum Sq Mean Sq F value
riego         1   2.03  2.0329  3.0011
geno         14 412.99 29.4995 43.5494
riego:geno   14  16.06  1.1470  1.6933</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ol <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(twue<span class="sc">~</span>riego<span class="sc">*</span>geno, fb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ol</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$stats
         [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]
[1,] 4.333614 4.130962 3.183466 3.562696 6.476797 7.016632 3.335093 4.800000
[2,] 4.333614 4.400978 3.619318 3.783479 6.476797 7.317846 5.019805 5.010925
[3,] 4.386293 4.615642 4.193455 4.385278 6.823665 7.602656 5.626227 5.414297
[4,] 4.532666 4.757709 4.276947 4.652204 6.940299 7.917650 6.225983 5.519361
[5,] 4.802757 5.150054 4.776426 4.994347 6.940299 8.357964 7.393228 5.519361
         [,9]    [,10]    [,11]    [,12]    [,13]    [,14]    [,15]    [,16]
[1,] 4.439571 4.261745 1.514146 1.095335 5.380732 5.295993 3.254780 1.670792
[2,] 4.732606 4.933578 1.646662 1.095335 5.871080 6.686257 3.391003 2.586673
[3,] 5.553876 5.339439 1.898436 1.241801 6.010178 7.243935 3.755974 3.150032
[4,] 5.965943 5.570847 2.081893 1.261283 7.309010 7.837624 4.032235 3.942741
[5,] 6.058818 6.267642 2.081893 1.261283 8.083695 8.560701 4.438164 5.178082
        [,17]    [,18]    [,19]    [,20]    [,21]    [,22]    [,23]    [,24]
[1,] 5.158315 4.483348 3.422535 5.485247 5.695901 8.128415 3.670327 3.602043
[2,] 5.197094 4.926574 4.807639 5.991585 6.992076 8.176944 3.996970 3.711210
[3,] 6.144310 5.400606 4.859519 6.199946 7.819392 8.386645 4.603876 3.721777
[4,] 7.007157 6.431851 6.080609 6.330988 7.921521 8.983201 5.170317 4.298501
[5,] 7.163498 7.642416 6.192647 6.330988 8.155686 9.261978 5.418728 4.545641
        [,25]    [,26]    [,27]    [,28]    [,29]    [,30]
[1,] 2.888384 2.841705 3.471557 3.967870 7.374170 5.369158
[2,] 2.888384 2.869364 3.471557 4.052329 7.374170 6.731153
[3,] 2.933191 3.255069 4.135114 4.445199 7.578562 7.186478
[4,] 2.997985 3.633937 4.221507 4.592812 7.638498 8.086094
[5,] 2.997985 4.477644 4.221507 4.592812 8.014676 8.108766

$n
 [1] 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5

$conf
         [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]
[1,] 4.245643 4.363577 3.728776 3.771439 6.496156 7.178835 4.773945 5.055038
[2,] 4.526942 4.867708 4.658134 4.999117 7.151173 8.026476 6.478509 5.773557
         [,9]    [,10]    [,11]    [,12]    [,13]    [,14]    [,15]    [,16]
[1,] 4.682404 4.889146 1.590903 1.124543 4.994141 6.430382 3.302881 2.191838
[2,] 6.425349 5.789732 2.205970 1.359060 7.026216 8.057488 4.209067 4.108227
        [,17]    [,18]    [,19]    [,20]    [,21]    [,22]    [,23]    [,24]
[1,] 4.865324 4.336982 3.960042 5.960124 7.162648 7.816946 3.774792 3.306799
[2,] 7.423296 6.464231 5.758997 6.439767 8.476135 8.956345 5.432961 4.136756
        [,25]    [,26]    [,27]    [,28]    [,29]    [,30]
[1,] 2.855747 2.714824 3.605201 4.063295 7.391788 6.229080
[2,] 3.010635 3.795315 4.665027 4.827103 7.765335 8.143876

$out
 [1] 3.5144020 5.1014147 8.3284133 6.3520045 3.3878664 0.5430797 3.4419607
 [8] 9.0568734 2.3829097 3.3550744 2.2966326 5.6570766 6.0905433 6.7433917

$group
 [1]  1  5  5  8 11 12 12 20 25 25 27 27 28 29

$names
 [1] "irrigado.G01" "sequia.G01"   "irrigado.G02" "sequia.G02"   "irrigado.G03"
 [6] "sequia.G03"   "irrigado.G04" "sequia.G04"   "irrigado.G05" "sequia.G05"  
[11] "irrigado.G06" "sequia.G06"   "irrigado.G07" "sequia.G07"   "irrigado.G08"
[16] "sequia.G08"   "irrigado.G09" "sequia.G09"   "irrigado.G10" "sequia.G10"  
[21] "irrigado.G11" "sequia.G11"   "irrigado.G12" "sequia.G12"   "irrigado.G13"
[26] "sequia.G13"   "irrigado.G14" "sequia.G14"   "irrigado.G15" "sequia.G15"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(inti)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: shiny</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: dplyr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: tidyr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'tidyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:Matrix':

    expand, pack, unpack</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: tibble</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">remove_outliers</span>(<span class="at">data =</span> fb</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                         ,<span class="at">formula =</span> twue <span class="sc">~</span> riego <span class="sc">+</span> geno <span class="sc">+</span> riego<span class="sc">*</span>geno <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>bloque)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>              ,<span class="at">plot_diag =</span> T</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$data
$data$raw
# A tibble: 150 × 5
   index riego    geno  bloque  twue
   &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;
 1 1     sequia   G01   II     4.40 
 2 2     sequia   G02   IV     4.99 
 3 3     irrigado G01   III    4.53 
 4 4     sequia   G02   I      4.65 
 5 5     irrigado G03   II     6.94 
 6 6     irrigado G04   V      6.23 
 7 7     irrigado G01   I      3.51 
 8 8     irrigado G05   IV     5.55 
 9 9     sequia   G06   II     0.543
10 10    sequia   G05   I      5.57 
# ℹ 140 more rows

$data$clean
    index    riego geno bloque      twue
1       1   sequia  G01     II 4.4009780
2       2   sequia  G02     IV 4.9943471
3       3 irrigado  G01    III 4.5326657
4       4   sequia  G02      I 4.6522039
5       5 irrigado  G03     II 6.9402985
6       6 irrigado  G04      V 6.2259831
7       7 irrigado  G01      I 3.5144020
8       8 irrigado  G05     IV 5.5538761
9       9   sequia  G06     II 0.5430797
10     10   sequia  G05      I 5.5708471
11     11 irrigado  G01     II 4.3336137
12     12   sequia  G07     II 7.8376238
13     13 irrigado  G08     II 3.2547799
14     14 irrigado  G06    III 2.0818931
15     15 irrigado  G09    III 5.1970936
16     16 irrigado  G10     II 4.8595194
17     17   sequia  G11      I 8.3866453
18     18   sequia  G12    III 4.2985008
19     19 irrigado  G07      I 5.3807320
20     20 irrigado  G04     II 5.0198052
21     21 irrigado  G13     II 2.3829097
22     22 irrigado  G14    III 2.2966326
23     23 irrigado  G04     IV 5.6262269
24     24   sequia  G04      V 6.3520045
25     25   sequia  G08      V 5.1780822
26     26   sequia  G04    III 5.5193608
27     27   sequia  G01     IV 4.6156423
28     28 irrigado  G10      I 3.4225352
29     29 irrigado  G08      V 4.0322353
30     30 irrigado  G02      V 4.7764260
31     31 irrigado  G07    III 7.3090099
32     32 irrigado  G08      I 3.3910035
33     33 irrigado  G14      V 4.2215074
34     34 irrigado  G03      I 5.1014147
35     35   sequia  G13    III 3.6339365
36     36   sequia  G01      V 4.7577093
37     37   sequia  G03      I 7.0166320
38     38 irrigado  G15    III 7.5785618
39     39 irrigado  G03     IV 8.3284133
40     40 irrigado  G09     IV 7.0071568
41     41 irrigado  G11     II 7.9215205
42     42   sequia  G03      V 7.3178458
43     43   sequia  G11    III 8.9832007
44     44 irrigado  G06      V 1.8984364
45     45   sequia  G05      V 6.2676416
46     46   sequia  G08     IV 3.9427412
47     47 irrigado  G11     IV 5.6959014
48     48   sequia  G11     II 8.1769437
49     49 irrigado  G10    III 6.0806089
50     50   sequia  G06     IV 1.2418015
51     51   sequia  G09      I 4.4833476
52     52 irrigado  G11      I 6.9920755
53     53   sequia  G11     IV 9.2619776
54     54 irrigado  G15     IV 6.7433917
55     55 irrigado  G13     IV 2.9331908
56     56   sequia  G14      V 6.0905433
57     57 irrigado  G02     IV 3.6193182
58     58 irrigado  G09     II 6.1443097
59     59 irrigado  G02    III 4.2769473
60     60   sequia  G08    III 3.1500325
61     61 irrigado  G06     II 1.5141457
62     62   sequia  G13     IV 3.2550694
63     63   sequia  G14    III 4.0523293
64     64   sequia  G04     II 5.0109250
65     65 irrigado  G11    III 8.1556856
66     66 irrigado  G07     II 6.0101781
67     67 irrigado  G08     IV 3.7559741
68     68   sequia  G05     IV 4.9335776
69     69 irrigado  G04      I 3.3350933
70     70 irrigado  G11      V 7.8193919
71     71 irrigado  G12      I 4.6038762
72     72   sequia  G14     IV 3.9678701
73     73   sequia  G07    III 8.5607009
74     74 irrigado  G03    III 6.4767971
75     75   sequia  G01      I 4.1309620
76     76   sequia  G04      I 4.8000000
77     77   sequia  G03     II 8.3579639
78     78 irrigado  G15     II 8.0146759
79     79   sequia  G12     IV 3.7217771
80     80   sequia  G12      I 4.5456406
81     81   sequia  G08      I 1.6707921
82     82   sequia  G05     II 4.2617450
83     83   sequia  G02     II 3.5626965
84     84   sequia  G10      I 5.9915849
85     85   sequia  G15      I 8.0860938
86     86 irrigado  G07      V 5.8710801
87     87   sequia  G10      V 9.0568734
88     88   sequia  G13     II 2.8693637
89     89   sequia  G07      V 6.6862568
90     90   sequia  G03    III 7.9176501
91     91   sequia  G15     IV 7.1864776
92     92   sequia  G13      I 2.8417047
93     93   sequia  G03     IV 7.6026555
94     94 irrigado  G10      V 4.8076387
95     95   sequia  G13      V 4.4776436
96     96   sequia  G09     II 4.9265744
97     97 irrigado  G14     IV 5.6570766
98     98 irrigado  G01      V 4.3862928
99     99   sequia  G01    III 5.1500544
100   100 irrigado  G06     IV 3.3878664
101   101   sequia  G04     IV 5.4142973
102   102 irrigado  G15      V 7.6384982
103   103 irrigado  G13    III 3.3550744
104   104 irrigado  G02     II 4.1934554
105   105   sequia  G08     II 2.5866732
106   106 irrigado  G04    III 7.3932282
107   107   sequia  G02      V 3.7834790
108   108   sequia  G06      V 3.4419607
109   109 irrigado  G15      I 7.3741701
110   110 irrigado  G13      V 2.8883837
111   111 irrigado  G05      V 4.7326064
112   112   sequia  G09    III 5.4006063
113   113   sequia  G09      V 7.6424159
114   114   sequia  G10     II 6.1999455
115   115 irrigado  G07     IV 8.0836954
116   116 irrigado  G05      I 4.4395712
117   117 irrigado  G02      I 3.1834663
118   118   sequia  G05    III 5.3394386
119   119 irrigado  G12     II 3.9969701
120   120   sequia  G15    III 6.7311528
121   121 irrigado  G13      I 2.9979854
122   122   sequia  G14     II 4.5928124
123   123   sequia  G12     II 3.7112096
124   124   sequia  G15     II 5.3691578
125   125 irrigado  G09      V 7.1634981
126   126   sequia  G06      I 1.2612832
127   127   sequia  G09     IV 6.4318508
128   128   sequia  G15      V 8.1087662
129   129 irrigado  G14      I 3.4715571
130   130   sequia  G06    III 1.0953347
131   131 irrigado  G01     IV 4.8027572
132   132 irrigado  G12    III 5.1703175
133   133   sequia  G12      V 3.6020427
134   134 irrigado  G12      V 5.4187279
135   135   sequia  G11      V 8.1284153
136   136 irrigado  G12     IV 3.6703273
137   137 irrigado  G09      I 5.1583154
138   138   sequia  G02    III 4.3852780
139   139   sequia  G07      I 5.2959927
140   140 irrigado  G08    III 4.4381641
141   141 irrigado  G06      I 1.6466622
142   142 irrigado  G10     IV 6.1926466
143   143 irrigado  G03      V 6.8236646
144   144   sequia  G07     IV 7.2439353
145   145 irrigado  G05    III 6.0588177
146   146   sequia  G14      I 4.4451993
147   147   sequia  G10    III 5.4852471
148   148 irrigado  G14     II 4.1351143
149   149 irrigado  G05     II 5.9659430
150   150   sequia  G10     IV 6.3309876


$outliers
 [1] index       riego       geno        bloque      twue        resi       
 [7] res_MAD     rawp.BHStud adjp        bholm       out_flag   
&lt;0 rows&gt; (o 0- extensión row.names)

$diagplot</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$model
$model$raw
Linear mixed model fit by REML ['lmerMod']
Formula: twue ~ riego + geno + riego * geno + (1 | bloque)
   Data: rawdt
REML criterion at convergence: 350.4457
Random effects:
 Groups   Name        Std.Dev.
 bloque   (Intercept) 0.400   
 Residual             0.823   
Number of obs: 150, groups:  bloque, 5
Fixed Effects:
        (Intercept)          riegosequia              genoG02  
            4.31395              0.29712             -0.30402  
            genoG03              genoG04              genoG05  
            2.42017              1.20612              1.03622  
            genoG06              genoG07              genoG08  
           -2.20815              2.21699             -0.53951  
            genoG09              genoG10              genoG11  
            1.82013              0.75864              3.00297  
            genoG12              genoG13              genoG14  
            0.25810             -1.40244             -0.35757  
            genoG15  riegosequia:genoG02  riegosequia:genoG03  
            3.15591             -0.03144              0.61131  
riegosequia:genoG04  riegosequia:genoG05  riegosequia:genoG06  
           -0.39787             -0.37264             -0.88623  
riegosequia:genoG07  riegosequia:genoG08  riegosequia:genoG09  
            0.29684             -0.76589             -0.65424  
riegosequia:genoG10  riegosequia:genoG11  riegosequia:genoG12  
            1.24322              0.97340             -0.89333  
riegosequia:genoG13  riegosequia:genoG14  riegosequia:genoG15  
            0.20691              0.37625             -0.67065  

$model$clean
Linear mixed model fit by REML ['lmerMod']
Formula: twue ~ riego + geno + riego * geno + (1 | bloque)
   Data: cleandt
REML criterion at convergence: 350.4457
Random effects:
 Groups   Name        Std.Dev.
 bloque   (Intercept) 0.400   
 Residual             0.823   
Number of obs: 150, groups:  bloque, 5
Fixed Effects:
        (Intercept)          riegosequia              genoG02  
            4.31395              0.29712             -0.30402  
            genoG03              genoG04              genoG05  
            2.42017              1.20612              1.03622  
            genoG06              genoG07              genoG08  
           -2.20815              2.21699             -0.53951  
            genoG09              genoG10              genoG11  
            1.82013              0.75864              3.00297  
            genoG12              genoG13              genoG14  
            0.25810             -1.40244             -0.35757  
            genoG15  riegosequia:genoG02  riegosequia:genoG03  
            3.15591             -0.03144              0.61131  
riegosequia:genoG04  riegosequia:genoG05  riegosequia:genoG06  
           -0.39787             -0.37264             -0.88623  
riegosequia:genoG07  riegosequia:genoG08  riegosequia:genoG09  
            0.29684             -0.76589             -0.65424  
riegosequia:genoG10  riegosequia:genoG11  riegosequia:genoG12  
            1.24322              0.97340             -0.89333  
riegosequia:genoG13  riegosequia:genoG14  riegosequia:genoG15  
            0.20691              0.37625             -0.67065  </code></pre>
</div>
</div>
</section>
<section id="box-plot-twue" class="level3" data-number="1.1.3">
<h3 data-number="1.1.3" class="anchored" data-anchor-id="box-plot-twue"><span class="header-section-number">1.1.3</span> Box Plot Twue</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot de Twue por Genotipo y Riego</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fb, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(geno), <span class="at">y =</span> twue, <span class="at">fill =</span> <span class="fu">factor</span>(riego))) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Genotipo"</span>, <span class="at">y =</span> <span class="st">"TWUE"</span>, <span class="at">fill =</span> <span class="st">"Riego"</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Boxplot de TWUE por Genotipo y Riego"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparación-de-medias-twue" class="level3" data-number="1.1.4">
<h3 data-number="1.1.4" class="anchored" data-anchor-id="comparación-de-medias-twue"><span class="header-section-number">1.1.4</span> Comparación de medias Twue</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ readr     2.1.5
✔ lubridate 1.9.3     ✔ stringr   1.5.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ tidyr::expand() masks Matrix::expand()
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
✖ tidyr::pack()   masks Matrix::pack()
✖ tidyr::unpack() masks Matrix::unpack()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> twue <span class="sc">~</span> bloque <span class="sc">+</span> geno <span class="sc">+</span> riego <span class="sc">+</span> riego <span class="sc">*</span> geno, <span class="at">data =</span> fb)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: twue
            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
bloque       4  21.91  5.4766  8.0849 8.721e-06 ***
geno        14 412.99 29.4995 43.5494 &lt; 2.2e-16 ***
riego        1   2.03  2.0329  3.0011   0.08587 .  
geno:riego  14  16.06  1.1470  1.6933   0.06609 .  
Residuals  116  78.58  0.6774                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>tukey_result <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(modelo, <span class="fu">c</span>(<span class="st">"geno"</span>, <span class="st">"riego"</span>), <span class="at">group =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(tukey_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
    MSerror  Df     Mean       CV      MSD
  0.6773802 116 5.167933 15.92573 2.001632

$parameters
   test     name.t ntr StudentizedRange alpha
  Tukey geno:riego  30         5.438172  0.05

$means
                 twue       std r        se       Min      Max      Q25
G01:irrigado 4.313946 0.4826143 5 0.3680707 3.5144020 4.802757 4.333614
G01:sequia   4.611069 0.3829721 5 0.3680707 4.1309620 5.150054 4.400978
G02:irrigado 4.009923 0.6180849 5 0.3680707 3.1834663 4.776426 3.619318
G02:sequia   4.275601 0.5960016 5 0.3680707 3.5626965 4.994347 3.783479
G03:irrigado 6.734118 1.1537158 5 0.3680707 5.1014147 8.328413 6.476797
G03:sequia   7.642549 0.5211273 5 0.3680707 7.0166320 8.357964 7.317846
G04:irrigado 5.520067 1.5035535 5 0.3680707 3.3350933 7.393228 5.019805
G04:sequia   5.419318 0.5979711 5 0.3680707 4.8000000 6.352005 5.010925
G05:irrigado 5.350163 0.7303131 5 0.3680707 4.4395712 6.058818 4.732606
G05:sequia   5.274650 0.7450284 5 0.3680707 4.2617450 6.267642 4.933578
G06:irrigado 2.105801 0.7496879 5 0.3680707 1.5141457 3.387866 1.646662
G06:sequia   1.516692 1.1150023 5 0.3680707 0.5430797 3.441961 1.095335
G07:irrigado 6.530939 1.1231683 5 0.3680707 5.3807320 8.083695 5.871080
G07:sequia   7.124902 1.2370306 5 0.3680707 5.2959927 8.560701 6.686257
G08:irrigado 3.774431 0.4807284 5 0.3680707 3.2547799 4.438164 3.391003
G08:sequia   3.305664 1.3347090 5 0.3680707 1.6707921 5.178082 2.586673
G09:irrigado 6.134075 0.9555273 5 0.3680707 5.1583154 7.163498 5.197094
G09:sequia   5.776959 1.2695510 5 0.3680707 4.4833476 7.642416 4.926574
G10:irrigado 5.072590 1.1301447 5 0.3680707 3.4225352 6.192647 4.807639
G10:sequia   6.612928 1.4036244 5 0.3680707 5.4852471 9.056873 5.991585
G11:irrigado 7.316915 1.0068233 5 0.3680707 5.6959014 8.155686 6.992076
G11:sequia   8.587437 0.5077295 5 0.3680707 8.1284153 9.261978 8.176944
G12:irrigado 4.572044 0.7449196 5 0.3680707 3.6703273 5.418728 3.996970
G12:sequia   3.975834 0.4192506 5 0.3680707 3.6020427 4.545641 3.711210
G13:irrigado 2.911509 0.3480842 5 0.3680707 2.3829097 3.355074 2.888384
G13:sequia   3.415544 0.6762225 5 0.3680707 2.8417047 4.477644 2.869364
G14:irrigado 3.956378 1.2231539 5 0.3680707 2.2966326 5.657077 3.471557
G14:sequia   4.629751 0.8574439 5 0.3680707 3.9678701 6.090543 4.052329
G15:irrigado 7.469860 0.4674377 5 0.3680707 6.7433917 8.014676 7.374170
G15:sequia   7.096330 1.1323939 5 0.3680707 5.3691578 8.108766 6.731153
                  Q50      Q75
G01:irrigado 4.386293 4.532666
G01:sequia   4.615642 4.757709
G02:irrigado 4.193455 4.276947
G02:sequia   4.385278 4.652204
G03:irrigado 6.823665 6.940299
G03:sequia   7.602656 7.917650
G04:irrigado 5.626227 6.225983
G04:sequia   5.414297 5.519361
G05:irrigado 5.553876 5.965943
G05:sequia   5.339439 5.570847
G06:irrigado 1.898436 2.081893
G06:sequia   1.241801 1.261283
G07:irrigado 6.010178 7.309010
G07:sequia   7.243935 7.837624
G08:irrigado 3.755974 4.032235
G08:sequia   3.150032 3.942741
G09:irrigado 6.144310 7.007157
G09:sequia   5.400606 6.431851
G10:irrigado 4.859519 6.080609
G10:sequia   6.199946 6.330988
G11:irrigado 7.819392 7.921521
G11:sequia   8.386645 8.983201
G12:irrigado 4.603876 5.170317
G12:sequia   3.721777 4.298501
G13:irrigado 2.933191 2.997985
G13:sequia   3.255069 3.633937
G14:irrigado 4.135114 4.221507
G14:sequia   4.445199 4.592812
G15:irrigado 7.578562 7.638498
G15:sequia   7.186478 8.086094

$comparison
NULL

$groups
                 twue    groups
G11:sequia   8.587437         a
G03:sequia   7.642549        ab
G15:irrigado 7.469860       abc
G11:irrigado 7.316915      abcd
G07:sequia   7.124902     abcde
G15:sequia   7.096330     abcde
G03:irrigado 6.734118    abcdef
G10:sequia   6.612928   abcdefg
G07:irrigado 6.530939   bcdefgh
G09:irrigado 6.134075  bcdefghi
G09:sequia   5.776959 bcdefghij
G04:irrigado 5.520067 cdefghijk
G04:sequia   5.419318  defghijk
G05:irrigado 5.350163 defghijkl
G05:sequia   5.274650 efghijklm
G10:irrigado 5.072590  fghijklm
G14:sequia   4.629751  ghijklmn
G01:sequia   4.611069   hijklmn
G12:irrigado 4.572044   hijklmn
G01:irrigado 4.313946    ijklmn
G02:sequia   4.275601    ijklmn
G02:irrigado 4.009923    jklmno
G12:sequia   3.975834    jklmno
G14:irrigado 3.956378    jklmno
G08:irrigado 3.774431     klmno
G13:sequia   3.415544     lmnop
G08:sequia   3.305664      mnop
G13:irrigado 2.911509       nop
G06:irrigado 2.105801        op
G06:sequia   1.516692         p

attr(,"class")
[1] "group"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gráfico-en-ggplot-2-para-twue" class="level3" data-number="1.1.5">
<h3 data-number="1.1.5" class="anchored" data-anchor-id="gráfico-en-ggplot-2-para-twue"><span class="header-section-number">1.1.5</span> Gráfico en ggplot 2 para Twue</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fb, <span class="fu">aes</span>(<span class="at">x =</span> geno, <span class="at">y =</span> twue, <span class="at">colour =</span> riego)) <span class="sc">+</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">"blue"</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot con interacción de niveles de riego y genotipo"</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">x =</span> <span class="st">"Interacción riego y genotipo"</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="st">"peso seco del tuberculo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comaparación-de-medias-emmeans-para-twue" class="level3" data-number="1.1.6">
<h3 data-number="1.1.6" class="anchored" data-anchor-id="comaparación-de-medias-emmeans-para-twue"><span class="header-section-number">1.1.6</span> Comaparación de medias: emmeans para twue</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome to emmeans.
Caution: You lose important information if you filter this package's results.
See '? untidy'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modelo, <span class="sc">~</span> riego <span class="sc">*</span> geno)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modelo, <span class="sc">~</span> riego <span class="sc">+</span> geno)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modelo, <span class="sc">~</span> geno <span class="sc">|</span> riego)<span class="sc">%&gt;%</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(mc)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>mc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>riego = irrigado:
 geno   emmean        SE  df lower.CL upper.CL
 G01  4.313946 0.3680707 116 3.584936 5.042957
 G02  4.009923 0.3680707 116 3.280912 4.738933
 G03  6.734118 0.3680707 116 6.005107 7.463128
 G04  5.520067 0.3680707 116 4.791057 6.249078
 G05  5.350163 0.3680707 116 4.621152 6.079173
 G06  2.105801 0.3680707 116 1.376790 2.834811
 G07  6.530939 0.3680707 116 5.801929 7.259950
 G08  3.774431 0.3680707 116 3.045421 4.503442
 G09  6.134075 0.3680707 116 5.405064 6.863085
 G10  5.072590 0.3680707 116 4.343579 5.801600
 G11  7.316915 0.3680707 116 6.587905 8.045925
 G12  4.572044 0.3680707 116 3.843033 5.301054
 G13  2.911509 0.3680707 116 2.182498 3.640519
 G14  3.956378 0.3680707 116 3.227367 4.685388
 G15  7.469860 0.3680707 116 6.740849 8.198870

riego = sequia:
 geno   emmean        SE  df lower.CL upper.CL
 G01  4.611069 0.3680707 116 3.882059 5.340080
 G02  4.275601 0.3680707 116 3.546590 5.004611
 G03  7.642549 0.3680707 116 6.913539 8.371560
 G04  5.419318 0.3680707 116 4.690307 6.148328
 G05  5.274650 0.3680707 116 4.545640 6.003660
 G06  1.516692 0.3680707 116 0.787682 2.245702
 G07  7.124902 0.3680707 116 6.395891 7.853912
 G08  3.305664 0.3680707 116 2.576654 4.034675
 G09  5.776959 0.3680707 116 5.047949 6.505969
 G10  6.612928 0.3680707 116 5.883917 7.341938
 G11  8.587437 0.3680707 116 7.858426 9.316447
 G12  3.975834 0.3680707 116 3.246824 4.704845
 G13  3.415544 0.3680707 116 2.686533 4.144554
 G14  4.629751 0.3680707 116 3.900740 5.358761
 G15  7.096330 0.3680707 116 6.367319 7.825340

Results are averaged over the levels of: bloque 
Confidence level used: 0.95 </code></pre>
</div>
</div>
</section>
<section id="plot-para-twue" class="level3" data-number="1.1.7">
<h3 data-number="1.1.7" class="anchored" data-anchor-id="plot-para-twue"><span class="header-section-number">1.1.7</span> Plot para twue</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mc, <span class="fu">aes</span>(<span class="at">x =</span> geno, <span class="at">y =</span> emmean, <span class="at">fill =</span> riego)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(aes(label = emmean), position = position_dodge(0.9), vjust = -0.5) +</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variedad"</span>, <span class="at">y =</span> <span class="st">"Twue"</span>, <span class="at">fill =</span> <span class="st">"Riego"</span>) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="variable-ttrans" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="variable-ttrans"><span class="header-section-number">1.2</span> Variable TTRANS</h2>
<section id="modelo-lineal-para-ttrans" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="modelo-lineal-para-ttrans"><span class="header-section-number">1.2.1</span> Modelo lineal para ttrans</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> ttrans <span class="sc">~</span> bloque <span class="sc">+</span> geno <span class="sc">+</span> riego <span class="sc">+</span> riego<span class="sc">*</span>geno, <span class="at">data =</span> fb)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: ttrans
            Df Sum Sq Mean Sq  F value  Pr(&gt;F)    
bloque       4  17.49    4.37   3.4162 0.01114 *  
geno        14 272.13   19.44  15.1897 &lt; 2e-16 ***
riego        1 416.31  416.31 325.3217 &lt; 2e-16 ***
geno:riego  14  29.71    2.12   1.6585 0.07398 .  
Residuals  116 148.44    1.28                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="modelo-lineal-mixto-para-ttrans" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="modelo-lineal-mixto-para-ttrans"><span class="header-section-number">1.2.2</span> Modelo lineal mixto para ttrans</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="at">formula =</span> ttrans <span class="sc">~</span> riego <span class="sc">+</span> geno <span class="sc">+</span> riego<span class="sc">*</span>geno <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>bloque)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>              ,<span class="at">data =</span> fb)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table
           npar Sum Sq Mean Sq  F value
riego         1 416.31  416.31 325.3217
geno         14 272.13   19.44  15.1897
riego:geno   14  29.71    2.12   1.6585</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>ol <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(ttrans<span class="sc">~</span>riego<span class="sc">*</span>geno, fb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>ol</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$stats
      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]   [,7]  [,8]   [,9] [,10] [,11] [,12]
[1,] 6.388 3.711 6.329 2.863 5.495 3.788  9.341 4.881  7.704 5.023 7.227 3.713
[2,] 6.420 4.086 6.329 2.904 5.867 3.813  9.341 4.881  8.208 5.023 7.227 3.944
[3,] 8.321 4.499 6.355 3.538 6.964 3.848 10.045 4.924  9.262 5.066 7.415 4.099
[4,] 8.388 5.971 6.937 3.547 7.370 4.067 10.188 5.400 10.167 5.159 7.522 4.364
[5,] 9.430 6.431 7.040 3.831 8.130 4.263 10.396 5.492 11.745 5.159 7.522 4.574
     [,13] [,14] [,15] [,16]  [,17] [,18] [,19] [,20] [,21] [,22]  [,23] [,24]
[1,] 1.965 2.196 6.747 3.650  7.890 4.684 3.291 3.499 4.893 2.928  7.921 4.469
[2,] 2.296 2.196 7.073 3.650  9.759 5.828 5.410 3.565 5.931 2.984  8.823 4.886
[3,] 2.377 2.212 7.114 4.067 11.010 6.927 5.680 3.671 7.663 4.524  9.288 5.483
[4,] 4.373 2.397 7.514 4.436 11.212 6.970 7.174 4.121 7.862 4.905 10.363 5.492
[5,] 5.838 2.525 7.514 4.619 12.296 7.082 8.014 4.121 9.247 5.002 11.320 6.316
     [,25] [,26] [,27] [,28]  [,29] [,30]
[1,] 7.666 3.371 7.929 4.416  6.734 4.429
[2,] 7.942 4.685 8.561 4.701  8.177 5.014
[3,] 9.237 4.719 9.059 4.970  9.338 5.502
[4,] 9.245 5.611 9.489 5.789  9.812 6.160
[5,] 9.355 6.570 9.489 6.066 10.374 6.249

$n
 [1] 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5

$conf
         [,1]     [,2]     [,3]     [,4]     [,5]     [,6]      [,7]     [,8]
[1,] 6.930416 3.167064 5.925389 3.083658 5.901984 3.668524  9.446512 4.557276
[2,] 9.711584 5.830936 6.784611 3.992342 8.026016 4.027476 10.643488 5.290724
          [,9]    [,10]    [,11]    [,12]    [,13]    [,14]    [,15]    [,16]
[1,]  7.877776 4.969903 7.206554 3.802229 0.909397 2.069974 6.802391 3.511614
[2,] 10.646224 5.162097 7.623446 4.395771 3.844603 2.354026 7.425609 4.622386
         [,17]    [,18]    [,19]    [,20]   [,21]    [,22]    [,23]    [,24]
[1,]  9.983314 6.120066 4.433562 3.278132 6.29856 3.166626  8.19984 5.054802
[2,] 12.036686 7.733934 6.926438 4.063868 9.02744 5.881374 10.37616 5.911198
         [,25]    [,26]    [,27]    [,28]     [,29]    [,30]
[1,]  8.316303 4.064691 8.403278 4.201222  8.182713 4.692239
[2,] 10.157697 5.373309 9.714722 5.738778 10.493287 6.311761

$out
 [1]  4.137  5.682  3.517  5.881  4.366  6.327 10.269  1.484  8.846  2.424
[11]  5.626 11.503

$group
 [1]  3  7  8 10 10 11 11 14 15 16 20 27

$names
 [1] "irrigado.G01" "sequia.G01"   "irrigado.G02" "sequia.G02"   "irrigado.G03"
 [6] "sequia.G03"   "irrigado.G04" "sequia.G04"   "irrigado.G05" "sequia.G05"  
[11] "irrigado.G06" "sequia.G06"   "irrigado.G07" "sequia.G07"   "irrigado.G08"
[16] "sequia.G08"   "irrigado.G09" "sequia.G09"   "irrigado.G10" "sequia.G10"  
[21] "irrigado.G11" "sequia.G11"   "irrigado.G12" "sequia.G12"   "irrigado.G13"
[26] "sequia.G13"   "irrigado.G14" "sequia.G14"   "irrigado.G15" "sequia.G15"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(inti)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">remove_outliers</span>(<span class="at">data =</span> fb</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                         ,<span class="at">formula =</span> ttrans <span class="sc">~</span> riego <span class="sc">+</span> geno <span class="sc">+</span> riego<span class="sc">*</span>geno <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>bloque)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>              ,<span class="at">plot_diag =</span> T</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$data
$data$raw
# A tibble: 150 × 5
   index riego    geno  bloque ttrans
   &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;
 1 1     sequia   G01   II       4.50
 2 2     sequia   G02   IV       3.54
 3 3     irrigado G01   III      8.39
 4 4     sequia   G02   I        2.90
 5 5     irrigado G03   II       7.37
 6 6     irrigado G04   V       10.0 
 7 7     irrigado G01   I        6.39
 8 8     irrigado G05   IV       9.26
 9 9     sequia   G06   II       4.36
10 10    sequia   G05   I        5.16
# ℹ 140 more rows

$data$clean
    index    riego geno bloque ttrans
1       1   sequia  G01     II  4.499
2       2   sequia  G02     IV  3.538
3       3 irrigado  G01    III  8.388
4       4   sequia  G02      I  2.904
5       5 irrigado  G03     II  7.370
6       6 irrigado  G04      V 10.045
7       7 irrigado  G01      I  6.388
8       8 irrigado  G05     IV  9.262
9       9   sequia  G06     II  4.364
10     10   sequia  G05      I  5.159
11     11 irrigado  G01     II  8.321
12     12   sequia  G07     II  2.525
13     13 irrigado  G08     II  6.747
14     14 irrigado  G06    III  7.522
15     15 irrigado  G09    III 11.010
16     16 irrigado  G10     II  5.410
17     17   sequia  G11      I  5.002
18     18   sequia  G12    III  4.469
19     19 irrigado  G07      I  2.377
20     20 irrigado  G04     II  9.341
21     21 irrigado  G13     II  9.245
22     22 irrigado  G14    III  7.929
23     23 irrigado  G04     IV 10.188
24     24   sequia  G04      V  3.517
25     25   sequia  G08      V  3.650
26     26   sequia  G04    III  4.881
27     27   sequia  G01     IV  5.971
28     28 irrigado  G10      I  5.680
29     29 irrigado  G08      V  7.073
30     30 irrigado  G02      V  6.329
31     31 irrigado  G07    III  5.838
32     32 irrigado  G08      I  7.514
33     33 irrigado  G14      V 11.503
34     34 irrigado  G03      I  5.867
35     35   sequia  G13    III  3.371
36     36   sequia  G01      V  4.086
37     37   sequia  G03      I  3.848
38     38 irrigado  G15    III 10.374
39     39 irrigado  G03     IV  8.130
40     40 irrigado  G09     IV 12.296
41     41 irrigado  G11     II  4.893
42     42   sequia  G03      V  3.788
43     43   sequia  G11    III  4.524
44     44 irrigado  G06      V  7.227
45     45   sequia  G05      V  5.881
46     46   sequia  G08     IV  4.436
47     47 irrigado  G11     IV  9.247
48     48   sequia  G11     II  2.984
49     49 irrigado  G10    III  8.014
50     50   sequia  G06     IV  4.574
51     51   sequia  G09      I  4.684
52     52 irrigado  G11      I  5.931
53     53   sequia  G11     IV  4.905
54     54 irrigado  G15     IV  6.734
55     55 irrigado  G13     IV  9.355
56     56   sequia  G14      V  4.970
57     57 irrigado  G02     IV  7.040
58     58 irrigado  G09     II 11.212
59     59 irrigado  G02    III  6.355
60     60   sequia  G08    III  4.619
61     61 irrigado  G06     II  6.327
62     62   sequia  G13     IV  4.685
63     63   sequia  G14    III  4.701
64     64   sequia  G04     II  5.492
65     65 irrigado  G11    III  7.862
66     66 irrigado  G07     II  1.965
67     67 irrigado  G08     IV  7.114
68     68   sequia  G05     IV  4.366
69     69 irrigado  G04      I  5.682
70     70 irrigado  G11      V  7.663
71     71 irrigado  G12      I  8.823
72     72   sequia  G14     IV  5.789
73     73   sequia  G07    III  2.397
74     74 irrigado  G03    III  5.495
75     75   sequia  G01      I  3.711
76     76   sequia  G04      I  5.400
77     77   sequia  G03     II  4.263
78     78 irrigado  G15     II  9.812
79     79   sequia  G12     IV  5.492
80     80   sequia  G12      I  4.886
81     81   sequia  G08      I  2.424
82     82   sequia  G05     II  5.066
83     83   sequia  G02     II  2.863
84     84   sequia  G10      I  3.565
85     85   sequia  G15      I  6.249
86     86 irrigado  G07      V  2.296
87     87   sequia  G10      V  3.499
88     88   sequia  G13     II  5.611
89     89   sequia  G07      V  2.212
90     90   sequia  G03    III  3.813
91     91   sequia  G15     IV  5.502
92     92   sequia  G13      I  6.570
93     93   sequia  G03     IV  4.067
94     94 irrigado  G10      V  7.174
95     95   sequia  G13      V  4.719
96     96   sequia  G09     II  7.082
97     97 irrigado  G14     IV  9.489
98     98 irrigado  G01      V  6.420
99     99   sequia  G01    III  6.431
100   100 irrigado  G06     IV 10.269
101   101   sequia  G04     IV  4.924
102   102 irrigado  G15      V  8.177
103   103 irrigado  G13    III  7.666
104   104 irrigado  G02     II  6.937
105   105   sequia  G08     II  4.067
106   106 irrigado  G04    III 10.396
107   107   sequia  G02      V  3.547
108   108   sequia  G06      V  3.713
109   109 irrigado  G15      I  9.338
110   110 irrigado  G13      V  9.237
111   111 irrigado  G05      V  7.704
112   112   sequia  G09    III  6.927
113   113   sequia  G09      V  5.828
114   114   sequia  G10     II  3.671
115   115 irrigado  G07     IV  4.373
116   116 irrigado  G05      I  8.208
117   117 irrigado  G02      I  4.137
118   118   sequia  G05    III  5.023
119   119 irrigado  G12     II  7.921
120   120   sequia  G15    III  5.014
121   121 irrigado  G13      I  7.942
122   122   sequia  G14     II  6.066
123   123   sequia  G12     II  6.316
124   124   sequia  G15     II  4.429
125   125 irrigado  G09      V  7.890
126   126   sequia  G06      I  4.099
127   127   sequia  G09     IV  6.970
128   128   sequia  G15      V  6.160
129   129 irrigado  G14      I  8.561
130   130   sequia  G06    III  3.944
131   131 irrigado  G01     IV  9.430
132   132 irrigado  G12    III 10.363
133   133   sequia  G12      V  5.483
134   134 irrigado  G12      V 11.320
135   135   sequia  G11      V  2.928
136   136 irrigado  G12     IV  9.288
137   137 irrigado  G09      I  9.759
138   138   sequia  G02    III  3.831
139   139   sequia  G07      I  2.196
140   140 irrigado  G08    III  8.846
141   141 irrigado  G06      I  7.415
142   142 irrigado  G10     IV  3.291
143   143 irrigado  G03      V  6.964
144   144   sequia  G07     IV  1.484
145   145 irrigado  G05    III 10.167
146   146   sequia  G14      I  4.416
147   147   sequia  G10    III  5.626
148   148 irrigado  G14     II  9.059
149   149 irrigado  G05     II 11.745
150   150   sequia  G10     IV  4.121


$outliers
 [1] index       riego       geno        bloque      ttrans      resi       
 [7] res_MAD     rawp.BHStud adjp        bholm       out_flag   
&lt;0 rows&gt; (o 0- extensión row.names)

$diagplot</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$model
$model$raw
Linear mixed model fit by REML ['lmerMod']
Formula: ttrans ~ riego + geno + riego * geno + (1 | bloque)
   Data: rawdt
REML criterion at convergence: 423.3364
Random effects:
 Groups   Name        Std.Dev.
 bloque   (Intercept) 0.321   
 Residual             1.131   
Number of obs: 150, groups:  bloque, 5
Fixed Effects:
        (Intercept)          riegosequia              genoG02  
             7.7894              -2.8498              -1.6298  
            genoG03              genoG04              genoG05  
            -1.0242               1.3410               1.6278  
            genoG06              genoG07              genoG08  
            -0.0374              -4.4196              -0.3306  
            genoG09              genoG10              genoG11  
             2.6440              -1.8756              -0.6702  
            genoG12              genoG13              genoG14  
             1.7536               0.8996               1.5188  
            genoG15  riegosequia:genoG02  riegosequia:genoG03  
             1.0976               0.0268               0.0404  
riegosequia:genoG04  riegosequia:genoG05  riegosequia:genoG06  
            -1.4378              -1.4684              -0.7634  
riegosequia:genoG07  riegosequia:genoG08  riegosequia:genoG09  
             1.6428              -0.7698              -1.2854  
riegosequia:genoG10  riegosequia:genoG11  riegosequia:genoG12  
             1.0324              -0.2008              -1.3640  
riegosequia:genoG13  riegosequia:genoG14  riegosequia:genoG15  
            -0.8480              -1.2700              -0.5664  

$model$clean
Linear mixed model fit by REML ['lmerMod']
Formula: ttrans ~ riego + geno + riego * geno + (1 | bloque)
   Data: cleandt
REML criterion at convergence: 423.3364
Random effects:
 Groups   Name        Std.Dev.
 bloque   (Intercept) 0.321   
 Residual             1.131   
Number of obs: 150, groups:  bloque, 5
Fixed Effects:
        (Intercept)          riegosequia              genoG02  
             7.7894              -2.8498              -1.6298  
            genoG03              genoG04              genoG05  
            -1.0242               1.3410               1.6278  
            genoG06              genoG07              genoG08  
            -0.0374              -4.4196              -0.3306  
            genoG09              genoG10              genoG11  
             2.6440              -1.8756              -0.6702  
            genoG12              genoG13              genoG14  
             1.7536               0.8996               1.5188  
            genoG15  riegosequia:genoG02  riegosequia:genoG03  
             1.0976               0.0268               0.0404  
riegosequia:genoG04  riegosequia:genoG05  riegosequia:genoG06  
            -1.4378              -1.4684              -0.7634  
riegosequia:genoG07  riegosequia:genoG08  riegosequia:genoG09  
             1.6428              -0.7698              -1.2854  
riegosequia:genoG10  riegosequia:genoG11  riegosequia:genoG12  
             1.0324              -0.2008              -1.3640  
riegosequia:genoG13  riegosequia:genoG14  riegosequia:genoG15  
            -0.8480              -1.2700              -0.5664  </code></pre>
</div>
</div>
</section>
<section id="box-plot-ttrans" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="box-plot-ttrans"><span class="header-section-number">1.2.3</span> Box Plot ttrans</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot de Ttrans por Genotipo y Riego</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fb, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(geno), <span class="at">y =</span> ttrans, <span class="at">fill =</span> <span class="fu">factor</span>(riego))) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Genotipo"</span>, <span class="at">y =</span> <span class="st">"ttrans"</span>, <span class="at">fill =</span> <span class="st">"Riego"</span>) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Boxplot de Ttrans por Genotipo y Riego"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparación-de-media-ttrans" class="level3" data-number="1.2.4">
<h3 data-number="1.2.4" class="anchored" data-anchor-id="comparación-de-media-ttrans"><span class="header-section-number">1.2.4</span> Comparación de media ttrans</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> ttrans <span class="sc">~</span> bloque <span class="sc">+</span> geno <span class="sc">+</span> riego <span class="sc">+</span> riego <span class="sc">*</span> geno, <span class="at">data =</span> fb)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: ttrans
            Df Sum Sq Mean Sq  F value  Pr(&gt;F)    
bloque       4  17.49    4.37   3.4162 0.01114 *  
geno        14 272.13   19.44  15.1897 &lt; 2e-16 ***
riego        1 416.31  416.31 325.3217 &lt; 2e-16 ***
geno:riego  14  29.71    2.12   1.6585 0.07398 .  
Residuals  116 148.44    1.28                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>tukey_result <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(modelo, <span class="fu">c</span>(<span class="st">"geno"</span>, <span class="st">"riego"</span>), <span class="at">group =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(tukey_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
   MSerror  Df     Mean       CV      MSD
  1.279687 116 6.183113 18.29552 2.751186

$parameters
   test     name.t ntr StudentizedRange alpha
  Tukey geno:riego  30         5.438172  0.05

$means
              ttrans       std r        se   Min    Max   Q25    Q50    Q75
G01:irrigado  7.7894 1.3389984 5 0.5059026 6.388  9.430 6.420  8.321  8.388
G01:sequia    4.9396 1.1958553 5 0.5059026 3.711  6.431 4.086  4.499  5.971
G02:irrigado  6.1596 1.1765674 5 0.5059026 4.137  7.040 6.329  6.355  6.937
G02:sequia    3.3366 0.4303200 5 0.5059026 2.863  3.831 2.904  3.538  3.547
G03:irrigado  6.7652 1.0826074 5 0.5059026 5.495  8.130 5.867  6.964  7.370
G03:sequia    3.9558 0.2042711 5 0.5059026 3.788  4.263 3.813  3.848  4.067
G04:irrigado  9.1304 1.9680301 5 0.5059026 5.682 10.396 9.341 10.045 10.188
G04:sequia    4.8428 0.7902105 5 0.5059026 3.517  5.492 4.881  4.924  5.400
G05:irrigado  9.4172 1.6126189 5 0.5059026 7.704 11.745 8.208  9.262 10.167
G05:sequia    5.0990 0.5383489 5 0.5059026 4.366  5.881 5.023  5.066  5.159
G06:irrigado  7.7520 1.4839144 5 0.5059026 6.327 10.269 7.227  7.415  7.522
G06:sequia    4.1388 0.3394668 5 0.5059026 3.713  4.574 3.944  4.099  4.364
G07:irrigado  3.3698 1.6741104 5 0.5059026 1.965  5.838 2.296  2.377  4.373
G07:sequia    2.1628 0.4032155 5 0.5059026 1.484  2.525 2.196  2.212  2.397
G08:irrigado  7.4588 0.8218514 5 0.5059026 6.747  8.846 7.073  7.114  7.514
G08:sequia    3.8392 0.8738906 5 0.5059026 2.424  4.619 3.650  4.067  4.436
G09:irrigado 10.4334 1.6831268 5 0.5059026 7.890 12.296 9.759 11.010 11.212
G09:sequia    6.2982 1.0353474 5 0.5059026 4.684  7.082 5.828  6.927  6.970
G10:irrigado  5.9138 1.8156611 5 0.5059026 3.291  8.014 5.410  5.680  7.174
G10:sequia    4.0964 0.8888925 5 0.5059026 3.499  5.626 3.565  3.671  4.121
G11:irrigado  7.1192 1.7133876 5 0.5059026 4.893  9.247 5.931  7.663  7.862
G11:sequia    4.0686 1.0314450 5 0.5059026 2.928  5.002 2.984  4.524  4.905
G12:irrigado  9.5430 1.3270680 5 0.5059026 7.921 11.320 8.823  9.288 10.363
G12:sequia    5.3292 0.7000541 5 0.5059026 4.469  6.316 4.886  5.483  5.492
G13:irrigado  8.6890 0.8150972 5 0.5059026 7.666  9.355 7.942  9.237  9.245
G13:sequia    4.9912 1.1905525 5 0.5059026 3.371  6.570 4.685  4.719  5.611
G14:irrigado  9.3082 1.3576116 5 0.5059026 7.929 11.503 8.561  9.059  9.489
G14:sequia    5.1884 0.7093591 5 0.5059026 4.416  6.066 4.701  4.970  5.789
G15:irrigado  8.8870 1.4499745 5 0.5059026 6.734 10.374 8.177  9.338  9.812
G15:sequia    5.4708 0.7706456 5 0.5059026 4.429  6.249 5.014  5.502  6.160

$comparison
NULL

$groups
              ttrans groups
G09:irrigado 10.4334      a
G12:irrigado  9.5430     ab
G05:irrigado  9.4172    abc
G14:irrigado  9.3082    abc
G04:irrigado  9.1304    abc
G15:irrigado  8.8870   abcd
G13:irrigado  8.6890   abcd
G01:irrigado  7.7894  abcde
G06:irrigado  7.7520  abcde
G08:irrigado  7.4588  bcdef
G11:irrigado  7.1192  bcdef
G03:irrigado  6.7652  cdefg
G09:sequia    6.2982  defgh
G02:irrigado  6.1596  defgh
G10:irrigado  5.9138  efghi
G15:sequia    5.4708  efghi
G12:sequia    5.3292  efghi
G14:sequia    5.1884  efghi
G05:sequia    5.0990  efghi
G13:sequia    4.9912   fghi
G01:sequia    4.9396   fghi
G04:sequia    4.8428  fghij
G06:sequia    4.1388   ghij
G10:sequia    4.0964   ghij
G11:sequia    4.0686   ghij
G03:sequia    3.9558    hij
G08:sequia    3.8392    hij
G07:irrigado  3.3698     ij
G02:sequia    3.3366     ij
G07:sequia    2.1628      j

attr(,"class")
[1] "group"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gráfico-en-ggplot-2-para-twue-1" class="level3" data-number="1.2.5">
<h3 data-number="1.2.5" class="anchored" data-anchor-id="gráfico-en-ggplot-2-para-twue-1"><span class="header-section-number">1.2.5</span> Gráfico en ggplot 2 para Twue</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> twue <span class="sc">~</span> bloque <span class="sc">+</span> geno <span class="sc">+</span> riego <span class="sc">+</span>riego<span class="sc">*</span>geno , <span class="at">data =</span> fb)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: twue
            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
bloque       4  21.91  5.4766  8.0849 8.721e-06 ***
geno        14 412.99 29.4995 43.5494 &lt; 2.2e-16 ***
riego        1   2.03  2.0329  3.0011   0.08587 .  
geno:riego  14  16.06  1.1470  1.6933   0.06609 .  
Residuals  116  78.58  0.6774                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fb, <span class="fu">aes</span>(<span class="at">x =</span> geno, <span class="at">y =</span> twue, <span class="at">colour =</span> riego)) <span class="sc">+</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">"blue"</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot con interacción de niveles de riego y genotipo"</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">x =</span> <span class="st">"Interacción riego y genotipo"</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="st">"uso eficiente del agua del tubérculo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comaparación-de-medias-emmeans-para-ttrans" class="level3" data-number="1.2.6">
<h3 data-number="1.2.6" class="anchored" data-anchor-id="comaparación-de-medias-emmeans-para-ttrans"><span class="header-section-number">1.2.6</span> Comaparación de medias: emmeans para ttrans</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modelo, <span class="sc">~</span> riego <span class="sc">*</span> geno)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modelo, <span class="sc">~</span> riego <span class="sc">+</span> geno)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modelo, <span class="sc">~</span> geno <span class="sc">|</span> riego)<span class="sc">%&gt;%</span> </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(mc)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>mc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>riego = irrigado:
 geno   emmean        SE  df lower.CL upper.CL
 G01  4.313946 0.3680707 116 3.584936 5.042957
 G02  4.009923 0.3680707 116 3.280912 4.738933
 G03  6.734118 0.3680707 116 6.005107 7.463128
 G04  5.520067 0.3680707 116 4.791057 6.249078
 G05  5.350163 0.3680707 116 4.621152 6.079173
 G06  2.105801 0.3680707 116 1.376790 2.834811
 G07  6.530939 0.3680707 116 5.801929 7.259950
 G08  3.774431 0.3680707 116 3.045421 4.503442
 G09  6.134075 0.3680707 116 5.405064 6.863085
 G10  5.072590 0.3680707 116 4.343579 5.801600
 G11  7.316915 0.3680707 116 6.587905 8.045925
 G12  4.572044 0.3680707 116 3.843033 5.301054
 G13  2.911509 0.3680707 116 2.182498 3.640519
 G14  3.956378 0.3680707 116 3.227367 4.685388
 G15  7.469860 0.3680707 116 6.740849 8.198870

riego = sequia:
 geno   emmean        SE  df lower.CL upper.CL
 G01  4.611069 0.3680707 116 3.882059 5.340080
 G02  4.275601 0.3680707 116 3.546590 5.004611
 G03  7.642549 0.3680707 116 6.913539 8.371560
 G04  5.419318 0.3680707 116 4.690307 6.148328
 G05  5.274650 0.3680707 116 4.545640 6.003660
 G06  1.516692 0.3680707 116 0.787682 2.245702
 G07  7.124902 0.3680707 116 6.395891 7.853912
 G08  3.305664 0.3680707 116 2.576654 4.034675
 G09  5.776959 0.3680707 116 5.047949 6.505969
 G10  6.612928 0.3680707 116 5.883917 7.341938
 G11  8.587437 0.3680707 116 7.858426 9.316447
 G12  3.975834 0.3680707 116 3.246824 4.704845
 G13  3.415544 0.3680707 116 2.686533 4.144554
 G14  4.629751 0.3680707 116 3.900740 5.358761
 G15  7.096330 0.3680707 116 6.367319 7.825340

Results are averaged over the levels of: bloque 
Confidence level used: 0.95 </code></pre>
</div>
</div>
</section>
<section id="plot-para-ttrans" class="level3" data-number="1.2.7">
<h3 data-number="1.2.7" class="anchored" data-anchor-id="plot-para-ttrans"><span class="header-section-number">1.2.7</span> Plot para ttrans</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mc, <span class="fu">aes</span>(<span class="at">x =</span> geno, <span class="at">y =</span> emmean, <span class="at">fill =</span> riego)) <span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(aes(label = emmean), position = position_dodge(0.9), vjust = -0.5) +</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variedad"</span>, <span class="at">y =</span> <span class="st">"Twue"</span>, <span class="at">fill =</span> <span class="st">"Riego"</span>) <span class="sc">+</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="análisis-multivariado" class="level3" data-number="1.2.8">
<h3 data-number="1.2.8" class="anchored" data-anchor-id="análisis-multivariado"><span class="header-section-number">1.2.8</span> Análisis multivariado</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.95 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Eliminar filas con NA y seleccionar solo columnas numéricas no vacías</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>fb_clean <span class="ot">&lt;-</span> fb <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(<span class="sc">~</span> <span class="fu">is.numeric</span>(.) <span class="sc">&amp;&amp;</span> <span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span>  <span class="co"># Selecciona solo columnas numéricas con al menos un valor no NA</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()  <span class="co"># Elimina filas con NA restantes</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar que hay columnas numéricas suficientes para calcular la correlación</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">ncol</span>(fb_clean) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcular la matriz de correlación</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(fb_clean, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Imprimir la matriz de correlación</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(cor_matrix)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Visualizar la matriz de correlación</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">"circle"</span>)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"No hay suficientes columnas numéricas o datos completos para calcular la correlación.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              block      spad_29     spad_83       rwc_84       op_84
block    1.00000000  0.020297706  0.05157597  0.008033140 -0.10231964
spad_29  0.02029771  1.000000000  0.14523944  0.006709501  0.12341708
spad_83  0.05157597  0.145239436  1.00000000 -0.374528084 -0.22948735
rwc_84   0.00803314  0.006709501 -0.37452808  1.000000000  0.57635594
op_84   -0.10231964  0.123417083 -0.22948735  0.576355944  1.00000000
leafdw   0.03708936  0.029866125  0.02659780  0.166241652  0.29327971
stemdw   0.02764730 -0.086066591  0.05998791 -0.032657508  0.06945152
rootdw  -0.01916446  0.321494560  0.38358101 -0.263783494 -0.05749859
tubdw    0.16073343 -0.159136398 -0.40105498  0.260742660  0.16170363
biomdw   0.13363294 -0.111659832 -0.23572155  0.196132929  0.20363811
hi       0.15638220 -0.115135314 -0.51302605  0.237267355  0.05818117
ttrans   0.06847173 -0.056829358 -0.29066112  0.318785712  0.34556360
wue      0.15069384 -0.082027344  0.14377046 -0.327544603 -0.36531517
twue     0.19761861 -0.117424881 -0.34394909  0.036235890 -0.11530021
lfa      0.03059648 -0.037591565 -0.27947045  0.485494652  0.51534633
             leafdw      stemdw      rootdw       tubdw     biomdw          hi
block    0.03708936  0.02764730 -0.01916446  0.16073343  0.1336329  0.15638220
spad_29  0.02986613 -0.08606659  0.32149456 -0.15913640 -0.1116598 -0.11513531
spad_83  0.02659780  0.05998791  0.38358101 -0.40105498 -0.2357216 -0.51302605
rwc_84   0.16624165 -0.03265751 -0.26378349  0.26074266  0.1961329  0.23726735
op_84    0.29327971  0.06945152 -0.05749859  0.16170363  0.2036381  0.05818117
leafdw   1.00000000  0.54016586  0.55299336  0.41870723  0.7597437 -0.34197634
stemdw   0.54016586  1.00000000  0.34559635  0.09917462  0.5565391 -0.47791080
rootdw   0.55299336  0.34559635  1.00000000 -0.11700388  0.2379613 -0.59973183
tubdw    0.41870723  0.09917462 -0.11700388  1.00000000  0.8503650  0.61676659
biomdw   0.75974368  0.55653907  0.23796129  0.85036500  1.0000000  0.16480490
hi      -0.34197634 -0.47791080 -0.59973183  0.61676659  0.1648049  1.00000000
ttrans   0.81729533  0.44296412  0.30930054  0.74443037  0.9038446  0.08493113
wue     -0.17692519  0.32789345 -0.12582406  0.10753641  0.1367143  0.08840298
twue    -0.34084015 -0.37075030 -0.54365961  0.58465861  0.1817833  0.89942081
lfa      0.78596157  0.37948900  0.22797158  0.52699081  0.7098837 -0.04955964
             ttrans         wue        twue         lfa
block    0.06847173  0.15069384  0.19761861  0.03059648
spad_29 -0.05682936 -0.08202734 -0.11742488 -0.03759157
spad_83 -0.29066112  0.14377046 -0.34394909 -0.27947045
rwc_84   0.31878571 -0.32754460  0.03623589  0.48549465
op_84    0.34556360 -0.36531517 -0.11530021  0.51534633
leafdw   0.81729533 -0.17692519 -0.34084015  0.78596157
stemdw   0.44296412  0.32789345 -0.37075030  0.37948900
rootdw   0.30930054 -0.12582406 -0.54365961  0.22797158
tubdw    0.74443037  0.10753641  0.58465861  0.52699081
biomdw   0.90384457  0.13671426  0.18178332  0.70988374
hi       0.08493113  0.08840298  0.89942081 -0.04955964
ttrans   1.00000000 -0.27920737 -0.05180976  0.86065462
wue     -0.27920737  1.00000000  0.46506419 -0.36555108
twue    -0.05180976  0.46506419  1.00000000 -0.20092298
lfa      0.86065462 -0.36555108 -0.20092298  1.00000000</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'psych'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>fb <span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(<span class="st">"block"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs.panels</span>(<span class="at">x =</span> .</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>               , <span class="at">hist.col=</span><span class="st">"red"</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>               , <span class="at">pch =</span> <span class="dv">21</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>               , <span class="at">stars =</span> <span class="cn">TRUE</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>               , <span class="at">scale =</span> <span class="cn">FALSE</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>               , <span class="at">lm =</span> <span class="cn">TRUE</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>               )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pca-para-ttrans" class="level3" data-number="1.2.9">
<h3 data-number="1.2.9" class="anchored" data-anchor-id="pca-para-ttrans"><span class="header-section-number">1.2.9</span> PCA para ttrans</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrupar y resumir los datos</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>mv <span class="ot">&lt;-</span> fb <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(riego, geno) <span class="sc">%&gt;%</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">"mean_{col}"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()  <span class="co"># Desagrupar los datos después de resumir</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'riego'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar el PCA, ajustando quali.sup a las columnas cualitativas (riego y geno)</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">PCA</span>(mv, <span class="at">scale.unit =</span> <span class="cn">TRUE</span>, <span class="at">quali.sup =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar los individuos</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot.PCA</span>(pca_result, <span class="at">habillage =</span> <span class="st">"riego"</span>, <span class="at">title =</span> <span class="st">"Gráfico de Individuos"</span>)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar las variables</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot.PCA</span>(pca_result, <span class="at">choix =</span> <span class="st">"var"</span>, <span class="at">title =</span> <span class="st">"Gráfico de Variables"</span>)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar las gráficas en una sola</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TRABAJO-SEGUNDA-UNIDAD_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>